#summary The built-in user management system

Karrigell provides a set of functions to manage user management. They rely on a users database and uses a script to manage users login and logout

Different roles can be set to users, to specify different access right to scripts or files. The levels can be "admin", "edit" or "visit". Usually, an administrator has all read and write access to all folders, files and scripts ; editors can read and modify some pages ; visitors can only see a set of pages

= Users database =

An application defines its user database by the attribute users_db (see ApplicationSettings)

It is an instance of a database management class. The module <font color="#336633"><b>admin_db</b></font> provides one such class :

==SQLiteUsersDb(_db`_`path_)==
This class stores user information in a SQLite database. It is initialized with one argument : the path of the database in the file system

= Login script =

An application defines a script that will be used to ask a user his login and password, and that will check that they match a user in the database

The url of this script is specified with the application attribute login`_`url. It defaults to (root`_`url)/admin/login.py/login, that is, the function login() in the script login.py in folder admin of the Karrigell distribution

The login script can be customized, but the arguments of the login() functions must remain the same as in this default script :
  * _role_ : the requested role
  * _origin_ : the url of the script where the Login() function was called. It is used to redirect the user to this original script if the login was successful

= Functions =

The functions available in scripts to manage users are :

==Login(_`[`role`[`,login`_`url`]]`_)==
When the framework runs this function, it checks that if the user is already authenticated and has the required role (admin, edit or visit). If a user has the admin role, he also has the edit and visit role ; if it has the edit role, he also has the visit role

If the user is not authenticated, or does not have the required role, a redirection to the specified login`_`url described above is performed

_role_ defaults to "admin". _login`_`url_ defaults to the url of the login script defined above

==Logout(_`[`redir`_`to`]`_)==
When this function is run, the cookies used to store information about a logged in user are erased, so that he is no longer authenticated
The optional _redir`_`to_ argument indicated the url where the user should be redirected after this logout operation was performed. It defaults to the url of the script where the Logout() function was run

==Role()==
This function returns :
  * <font color="#333388"><b>None</b></font> if no users database was defined for the application
  * <font color="#333388"><b>False</b></font> if the user is not yet authenticated
  * the users role (admin, edit or visit) if he is already authenticated